(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"./src/utils/TreeControl.mdx":function(n,e,t){"use strict";t.r(e),t.d(e,"default",(function(){return s}));var i=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),r=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),d=(t("react"),t("./node_modules/@mdx-js/react/dist/esm.js")),l=t("./node_modules/father/node_modules/docz/dist/index.esm.js"),a=(t("./node_modules/antd/dist/antd.css"),t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js")),o=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js"),c=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"value",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";if(Object(a.a)(this,n),this.dataGetter=void 0,this.childrenGetter=void 0,this.childrenCreater=void 0,!e)throw new Error("dataGetter need value");if(!t)throw new Error("childrenGetter need value");this.dataGetter=e,this.childrenGetter=t,this.childrenCreater=i}return Object(o.a)(n,[{key:"filter",value:function(n,e){return this._filterInner(n,e,null)}},{key:"_filterInner",value:function(n,e,t){if(!n)return[];for(var r=[],d=0;d<n.length;d++){var l=Object(i.a)({},n[d]);if(e(l,d,t))r.push(l);else{var a=this._filterInner(this.getChildren(l),e,l);a&&a.length>0&&(r.push(l),this._createChildren(l,a))}}return r}},{key:"listToTree",value:function(n,e){return this.innerListTree(n,e,null)}},{key:"innerListTree",value:function(n,e,t){if(!n)return[];for(var i=[],r=0;r<n.length;r++){var d=n[r];if(e(d,t)){i.push(d);var l=this.innerListTree(n,e,d);l&&l.length&&this._createChildren(d,l)}}return i}},{key:"search",value:function(n,e){var t=this._searchChainInner(n,e);return t&&t.length?t[t.length-1]:null}},{key:"searchParent",value:function(n,e){var t=this._searchChainInner(n,e);return t&&t.length>=2?t[t.length-2]:null}},{key:"getIndex",value:function(n,e){var t=this.searchParent(n,e);if(t)for(var i=this.getChildren(t),r=0;r<i.length;r++)if(e(i[r],r,t))return r;return-1}},{key:"addAt",value:function(n,e,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=this.search(n,e);if(r){var d=this.getChildren(r);if(d||(d=this._createChildren(r)),d){var l=Math.max(0,Math.min(d.length,i));d[l]=t}}}},{key:"remove",value:function(n,e){this._removeInner(n,e)}},{key:"_removeInner",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)for(var i=0;i<n.length;i++){var r=n[i];e(r,i,t)?(n.splice(i,1),i--):this._removeInner(this.getChildren(r),e,r)}}},{key:"searchChain",value:function(n,e){return this._searchChainInner(n,e)}},{key:"forEach",value:function(n,e){this._forEachInner(n,e)}},{key:"find",value:function(n,e){var t=[];return this.forEach(n,(function(n,i,r){e(n,i,r)&&t.push(n)})),t}},{key:"count",value:function(n){var e=0;return this.forEach(n,(function(){e++})),e}},{key:"map",value:function(n,e){return this._mapInner(n,e)}},{key:"_mapInner",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n){for(var i=[],r=0;r<n.length;r++){var d=n[r],l=this._mapInner(this.getChildren(d),e,d),a=e(d,r,t,l);i.push(a)}return i}return null}},{key:"_searchChainInner",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)for(var i=0;i<n.length;i++){var r=n[i];if(e(r,i,t))return[r];var d=this.getChildren(r);if(d){var l=this._searchChainInner(d,e,r);if(l)return l.unshift(r),l}}return null}},{key:"_forEachInner",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)for(var i=0;i<n.length;i++){var r=n[i];e(r,i,t),this._forEachInner(this.getChildren(r),e)}return null}},{key:"getNodeData",value:function(n){return this.dataGetter instanceof Function?this.dataGetter(n):n[this.dataGetter]}},{key:"getChildren",value:function(n){return this.childrenGetter instanceof Function?this.childrenGetter(n):n[this.childrenGetter]}},{key:"_createChildren",value:function(n,e){return this.childrenCreater instanceof Function?this.childrenCreater(n,e):(n[this.childrenCreater]=e||[],n[this.childrenCreater])}}]),n}(),p=c;"undefined"!==typeof c&&c&&c===Object(c)&&Object.isExtensible(c)&&Object.defineProperty(c,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"TreeControl",filename:"src/utils/TreeControl.ts"}});var u={};function s(n){var e,t,a=n.components,o=Object(r.a)(n,["components"]);return Object(d.b)("wrapper",Object.assign({},u,o,{components:a,mdxType:"MDXLayout"}),Object(d.b)("h1",{id:"treecontrol"},"TreeControl"),Object(d.b)("p",null,"\u6811\u76f8\u5173\u7684\u8f85\u52a9\u5de5\u5177"),Object(d.b)("ul",null,Object(d.b)("li",{parentName:"ul"},"\u4e00\u7ef4\u6570\u7ec4\u8f6c\u6362\u4e3a\u6811\u7ed3\u6784"),Object(d.b)("li",{parentName:"ul"},"\u641c\u7d22\u6307\u5b9a\u7684\u7ed3\u70b9"),Object(d.b)("li",{parentName:"ul"},"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9\u53ca\u5176\u6240\u6709\u7236\u7ed3\u70b9"),Object(d.b)("li",{parentName:"ul"},"foreach"),Object(d.b)("li",{parentName:"ul"},"map")),Object(d.b)("h3",{id:"\u6570\u7ec4\u8f6c\u6362\u4e3a\u6811"},"\u6570\u7ec4\u8f6c\u6362\u4e3a\u6811"),Object(d.b)("p",null,Object(d.b)("inlineCode",{parentName:"p"},"control.listToTree")),Object(d.b)(l.c,{__position:0,__code:"<div>\n  {(function renderTree() {\n    let list = [\n      {\n        id: 1,\n      },\n      {\n        id: 2,\n      },\n      {\n        id: 3,\n      },\n      {\n        id: '1-1',\n        pid: 1,\n      },\n      {\n        id: '1-2',\n        pid: 1,\n      },\n      {\n        id: '2-1',\n        pid: 2,\n      },\n    ]\n    let control = new TreeControl('id', 'children', 'children')\n    let tree = control.listToTree(\n      list.map(item => ({ ...item })),\n      (node, parent) => {\n        if (!parent) {\n          return !node.pid\n        }\n        return node.pid === parent.id\n      },\n    )\n    return (\n      <div>\n        <h2>\u539f\u59cb\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(list, null, 4)}</p>\n        <h2>\u6811\u7ed3\u6784</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(tree, null, 4)}</p>\n      </div>\n    )\n  })()}\n</div>",__scope:{props:this?this.props:o,Playground:l.c,Props:l.d,TreeControl:p},__codesandbox:"undefined",mdxType:"Playground"},Object(d.b)("div",null,(e=[{id:1},{id:2},{id:3},{id:"1-1",pid:1},{id:"1-2",pid:1},{id:"2-1",pid:2}],t=new p("id","children","children").listToTree(e.map((function(n){return Object(i.a)({},n)})),(function(n,e){return e?n.pid===e.id:!n.pid})),Object(d.b)("div",null,Object(d.b)("h2",null,"\u539f\u59cb\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(e,null,4)),Object(d.b)("h2",null,"\u6811\u7ed3\u6784"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(t,null,4)))))),Object(d.b)("h3",{id:"\u8fc7\u6ee4\u51fa\u65b0\u7684\u6811"},"\u8fc7\u6ee4\u51fa\u65b0\u7684\u6811"),Object(d.b)("p",null,"\u6311\u9009\u51faname\u5305\u542ba\u7684\u6570\u636e\uff1a",Object(d.b)("inlineCode",{parentName:"p"},"control.filter")),Object(d.b)(l.c,{__position:1,__code:"<div>\n  {(function renderTree() {\n    let list = [\n      {\n        id: 1,\n      },\n      {\n        id: 2,\n      },\n      {\n        id: 3,\n      },\n      {\n        id: '1-1',\n        pid: 1,\n      },\n      {\n        id: '1-1-2',\n        pid: '1-1',\n        name: 'a111',\n      },\n      {\n        id: '1-2',\n        pid: 1,\n      },\n      {\n        id: '2-1',\n        pid: 2,\n        name: 'a21',\n      },\n    ]\n    let control = new TreeControl('id', 'children', 'children')\n    let tree = control.listToTree(\n      list.map(item => ({ ...item })),\n      (node, parent) => {\n        if (!parent) {\n          return !node.pid\n        }\n        return node.pid === parent.id\n      },\n    )\n    let filterList = control.filter(tree, node => {\n      return node.name && node.name.indexOf('a') >= 0\n    })\n    return (\n      <div>\n        <h2>\u539f\u59cb\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(list, null, 4)}</p>\n        <h2>\u6811\u7ed3\u6784</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(tree, null, 4)}</p>\n        <h2>\u8fc7\u6ee4\u51fa\u7684\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>\n          {JSON.stringify(filterList, null, 4)}\n        </p>\n      </div>\n    )\n  })()}\n</div>",__scope:{props:this?this.props:o,Playground:l.c,Props:l.d,TreeControl:p},__codesandbox:"undefined",mdxType:"Playground"},Object(d.b)("div",null,function(){var n=[{id:1},{id:2},{id:3},{id:"1-1",pid:1},{id:"1-1-2",pid:"1-1",name:"a111"},{id:"1-2",pid:1},{id:"2-1",pid:2,name:"a21"}],e=new p("id","children","children"),t=e.listToTree(n.map((function(n){return Object(i.a)({},n)})),(function(n,e){return e?n.pid===e.id:!n.pid})),r=e.filter(t,(function(n){return n.name&&n.name.indexOf("a")>=0}));return Object(d.b)("div",null,Object(d.b)("h2",null,"\u539f\u59cb\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(n,null,4)),Object(d.b)("h2",null,"\u6811\u7ed3\u6784"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(t,null,4)),Object(d.b)("h2",null,"\u8fc7\u6ee4\u51fa\u7684\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(r,null,4)))}())),Object(d.b)("h3",{id:"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9"},"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9"),Object(d.b)("p",null,"\u6311\u9009\u51faname\u5305\u542ba\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\uff1a",Object(d.b)("inlineCode",{parentName:"p"},"control.search")),Object(d.b)(l.c,{__position:2,__code:"<div>\n  {(function renderTree() {\n    let list = [\n      {\n        id: 1,\n      },\n      {\n        id: 2,\n      },\n      {\n        id: 3,\n      },\n      {\n        id: '1-1',\n        pid: 1,\n      },\n      {\n        id: '1-1-2',\n        pid: '1-1',\n        name: 'a111',\n      },\n      {\n        id: '1-2',\n        pid: 1,\n      },\n      {\n        id: '2-1',\n        pid: 2,\n        name: 'a21',\n      },\n    ]\n    let control = new TreeControl('id', 'children', 'children')\n    let tree = control.listToTree(\n      list.map(item => ({ ...item })),\n      (node, parent) => {\n        if (!parent) {\n          return !node.pid\n        }\n        return node.pid === parent.id\n      },\n    )\n    let nodes = control.search(tree, node => {\n      return node.name && node.name.indexOf('a') >= 0\n    })\n    return (\n      <div>\n        <h2>\u539f\u59cb\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(list, null, 4)}</p>\n        <h2>\u8fc7\u6ee4\u51fa\u7684\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(nodes, null, 4)}</p>\n      </div>\n    )\n  })()}\n</div>",__scope:{props:this?this.props:o,Playground:l.c,Props:l.d,TreeControl:p},__codesandbox:"undefined",mdxType:"Playground"},Object(d.b)("div",null,function(){var n=[{id:1},{id:2},{id:3},{id:"1-1",pid:1},{id:"1-1-2",pid:"1-1",name:"a111"},{id:"1-2",pid:1},{id:"2-1",pid:2,name:"a21"}],e=new p("id","children","children"),t=e.listToTree(n.map((function(n){return Object(i.a)({},n)})),(function(n,e){return e?n.pid===e.id:!n.pid})),r=e.search(t,(function(n){return n.name&&n.name.indexOf("a")>=0}));return Object(d.b)("div",null,Object(d.b)("h2",null,"\u539f\u59cb\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(n,null,4)),Object(d.b)("h2",null,"\u8fc7\u6ee4\u51fa\u7684\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(r,null,4)))}())),Object(d.b)("h3",{id:"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9-1"},"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9"),Object(d.b)("p",null,"\u6311\u9009\u51faname\u5305\u542ba\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\u53ca\u5176\u6240\u6709\u7236\u7ed3\u70b9\uff1a",Object(d.b)("inlineCode",{parentName:"p"},"control.searchChain")),Object(d.b)(l.c,{__position:3,__code:"<div>\n  {(function renderTree() {\n    let list = [\n      {\n        id: 1,\n      },\n      {\n        id: 2,\n      },\n      {\n        id: 3,\n      },\n      {\n        id: '1-1',\n        pid: 1,\n      },\n      {\n        id: '1-1-2',\n        pid: '1-1',\n        name: 'a111',\n      },\n      {\n        id: '1-2',\n        pid: 1,\n      },\n      {\n        id: '2-1',\n        pid: 2,\n        name: 'a21',\n      },\n    ]\n    let control = new TreeControl('id', 'children', 'children')\n    let tree = control.listToTree(\n      list.map(item => ({ ...item })),\n      (node, parent) => {\n        if (!parent) {\n          return !node.pid\n        }\n        return node.pid === parent.id\n      },\n    )\n    let nodes = control.searchChain(tree, node => {\n      return node.name && node.name.indexOf('a') >= 0\n    })\n    return (\n      <div>\n        <h2>\u539f\u59cb\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(list, null, 4)}</p>\n        <h2>\u8fc7\u6ee4\u51fa\u7684\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(nodes, null, 4)}</p>\n      </div>\n    )\n  })()}\n</div>",__scope:{props:this?this.props:o,Playground:l.c,Props:l.d,TreeControl:p},__codesandbox:"undefined",mdxType:"Playground"},Object(d.b)("div",null,function(){var n=[{id:1},{id:2},{id:3},{id:"1-1",pid:1},{id:"1-1-2",pid:"1-1",name:"a111"},{id:"1-2",pid:1},{id:"2-1",pid:2,name:"a21"}],e=new p("id","children","children"),t=e.listToTree(n.map((function(n){return Object(i.a)({},n)})),(function(n,e){return e?n.pid===e.id:!n.pid})),r=e.searchChain(t,(function(n){return n.name&&n.name.indexOf("a")>=0}));return Object(d.b)("div",null,Object(d.b)("h2",null,"\u539f\u59cb\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(n,null,4)),Object(d.b)("h2",null,"\u8fc7\u6ee4\u51fa\u7684\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(r,null,4)))}())),Object(d.b)("h3",{id:"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9-2"},"\u641c\u7d22\u6307\u5b9a\u7ed3\u70b9"),Object(d.b)("p",null,"\u6311\u9009\u51faname\u5305\u542ba\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\uff1a",Object(d.b)("inlineCode",{parentName:"p"},"control.search")),Object(d.b)(l.c,{__position:4,__code:"<div>\n  {(function renderTree() {\n    let list = [\n      {\n        id: 1,\n      },\n      {\n        id: 2,\n      },\n      {\n        id: 3,\n      },\n      {\n        id: '1-1',\n        pid: 1,\n      },\n      {\n        id: '1-1-2',\n        pid: '1-1',\n        name: 'a111',\n      },\n      {\n        id: '1-2',\n        pid: 1,\n      },\n      {\n        id: '2-1',\n        pid: 2,\n        name: 'a21',\n      },\n    ]\n    let control = new TreeControl('id', 'children', 'children')\n    let tree = control.listToTree(\n      list.map(item => ({ ...item })),\n      (node, parent) => {\n        if (!parent) {\n          return !node.pid\n        }\n        return node.pid === parent.id\n      },\n    )\n    let nodes = control.search(tree, node => {\n      return node.name && node.name.indexOf('a') >= 0\n    })\n    return (\n      <div>\n        <h2>\u539f\u59cb\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(list, null, 4)}</p>\n        <h2>\u8fc7\u6ee4\u51fa\u7684\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(nodes, null, 4)}</p>\n      </div>\n    )\n  })()}\n</div>",__scope:{props:this?this.props:o,Playground:l.c,Props:l.d,TreeControl:p},__codesandbox:"undefined",mdxType:"Playground"},Object(d.b)("div",null,function(){var n=[{id:1},{id:2},{id:3},{id:"1-1",pid:1},{id:"1-1-2",pid:"1-1",name:"a111"},{id:"1-2",pid:1},{id:"2-1",pid:2,name:"a21"}],e=new p("id","children","children"),t=e.listToTree(n.map((function(n){return Object(i.a)({},n)})),(function(n,e){return e?n.pid===e.id:!n.pid})),r=e.search(t,(function(n){return n.name&&n.name.indexOf("a")>=0}));return Object(d.b)("div",null,Object(d.b)("h2",null,"\u539f\u59cb\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(n,null,4)),Object(d.b)("h2",null,"\u8fc7\u6ee4\u51fa\u7684\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(r,null,4)))}())),Object(d.b)("h3",{id:"\u904d\u5386\u6811"},"\u904d\u5386\u6811"),Object(d.b)("p",null,"\u7ed9\u6240\u6709\u7ed3\u70b9\u52a0\u4e0a\u65b0\u5c5e\u6027"),Object(d.b)(l.c,{__position:5,__code:"<div>\n  {(function renderTree() {\n    let list = [\n      {\n        id: 1,\n      },\n      {\n        id: 2,\n      },\n      {\n        id: 3,\n      },\n      {\n        id: '1-1',\n        pid: 1,\n      },\n      {\n        id: '1-1-2',\n        pid: '1-1',\n        name: 'a111',\n      },\n      {\n        id: '1-2',\n        pid: 1,\n      },\n      {\n        id: '2-1',\n        pid: 2,\n        name: 'a21',\n      },\n    ]\n    let control = new TreeControl('id', 'children', 'children')\n    let tree = control.listToTree(\n      list.map(item => ({ ...item })),\n      (node, parent) => {\n        if (!parent) {\n          return !node.pid\n        }\n        return node.pid === parent.id\n      },\n    )\n    control.forEach(tree, node => {\n      node.newAtt = 'newAtt'\n    })\n    return (\n      <div>\n        <h2>\u539f\u59cb\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(list, null, 4)}</p>\n        <h2>\u904d\u5386\u7684\u540e\u7684\u6570\u636e</h2>\n        <p style={{ whiteSpace: 'pre' }}>{JSON.stringify(tree, null, 4)}</p>\n      </div>\n    )\n  })()}\n</div>",__scope:{props:this?this.props:o,Playground:l.c,Props:l.d,TreeControl:p},__codesandbox:"undefined",mdxType:"Playground"},Object(d.b)("div",null,function(){var n=[{id:1},{id:2},{id:3},{id:"1-1",pid:1},{id:"1-1-2",pid:"1-1",name:"a111"},{id:"1-2",pid:1},{id:"2-1",pid:2,name:"a21"}],e=new p("id","children","children"),t=e.listToTree(n.map((function(n){return Object(i.a)({},n)})),(function(n,e){return e?n.pid===e.id:!n.pid}));return e.forEach(t,(function(n){n.newAtt="newAtt"})),Object(d.b)("div",null,Object(d.b)("h2",null,"\u539f\u59cb\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(n,null,4)),Object(d.b)("h2",null,"\u904d\u5386\u7684\u540e\u7684\u6570\u636e"),Object(d.b)("p",{style:{whiteSpace:"pre"}},JSON.stringify(t,null,4)))}())))}s&&s===Object(s)&&Object.isExtensible(s)&&Object.defineProperty(s,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"MDXContent",filename:"src/utils/TreeControl.mdx"}}),s.isMDXComponent=!0}}]);